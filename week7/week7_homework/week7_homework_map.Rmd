---
title: "Homework Week 7"
author: "Retno K. Ningrum"
date: "2024-10-09"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,                  #display the code
                      message = FALSE,              #do not show the message
                      warning = FALSE,              #do not show the warning
                      fig.path = "../output/")      #set the output for image
```

# Load Libraries
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(maps)
library(mapdata)
library(mapproj)


```

# Load and Inspect the Data
```{r}
#Read the plastic data
plastics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-26/plastics.csv')

#Read the world data (for mapping)
world <- map_data("world")

#Check the first 10 data
head(plastics)
head(world)

#check overall data
glimpse(plastics)
glimpse(world)
unique(plastics$country)  #to check the list of country covered in the plastics
unique(world$region)

```
After checking the dataset, I decide to focus on creating two different map:
1. Map of plastic distribution in Buru Island, Indonesia
2. Map of plastic distribution in Indonesia

# Creating Map of Plastic Distribution in Buru Island, Indonesia
My strategy : I will filter the "world" data with subregion "Buru", then join the data with "plastic" data. After that, I will create a map that represent the plastic distribution in Buru island using plot. 
```{r}
#join the data, but rename the category to be eligible for join package
plastic_indo <- plastics %>%
  filter(country == "Indonesia") %>%
  select("region" = country, grand_total) %>% #rename the country into "region"
  inner_join(world)                      #join data with world df

#check the data  
glimpse(plastic_indo)
unique(plastic_indo$subregion)

#create new dataset, choose only those in Buru island
buru_plastics <- plastic_indo %>%
  filter(subregion == "Buru")

glimpse(buru_plastics)
```
### Create the map of plastic distribution in buru island
```{r buru_map,  fig.align= 'center'}
ggplot() +
   geom_polygon(data = world, 
               aes(x = long, 
                   y = lat, 
                   group = group),         #"group" is a column in the data set, its a must.
                   color = "black", fill = "white") +     #boundaries of region
   geom_point(data = buru_plastics,
              aes(x= long, 
                  y = lat,
                  size = grand_total),
              color = "red", alpha = 0.1)+
     coord_map(projection = "mercator",
            xlim = c(125.8,127.3),
            ylim = c(-4, -2.7)) +
  labs(title = "Plastic Distribution in Buru Island",
       size = "# Plastics",
       x = "Longitude",
       y= "Latitude") +
  theme_minimal() +
  theme(panel.grid.major = element_line(color = "gray", linetype = "dotted"),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0.5, size = 16, face = "bold")) +
  # Add manual coordinate grid lines
   annotate("segment", x = seq(125.8, 127.5, by = 0.2), xend = seq(125.8, 127.5, by = 0.2),
            y = -4, yend = -2.7, color = "gray", linetype = "dotted") +  # Vertical gridlines
   annotate("segment", y = seq(-4, -2.7, by = 0.2), yend = seq(-4, -2.7, by = 0.2),
            x = 125.8, xend = 127.5, color = "gray", linetype = "dotted")  # Horizontal gridlines
 

```
### create the map of plastic distribution in Indonesia
```{r}
glimpse(plastic_indo)
glimpse(world)

# Step 1: Summarize plastic data by subregion
sum_plastic_indo <- plastic_indo %>%
  group_by(subregion) %>%
  summarise(total = sum(grand_total, na.rm = TRUE), .groups = 'drop')

indo_world <- world %>%
  filter(region == "Indonesia")
# Step 2: Merge the summarized plastic data with the world dataset
# Ensure that 'world' has polygons for each subregion in Indonesia
indo_plastic_map <- inner_join(indo_world, sum_plastic_indo, by = "subregion")  # Adjust based on your column names

# Step 3: Plot the map
ggplot(data = indo_plastic_map) +
  geom_polygon(aes(x = long, y = lat, group = group, fill = total), color = "black") +
  coord_map(projection = "mercator", xlim = c(95, 139), ylim = c(-10, 12)) +
  labs(title = "Plastic Distribution by Subregion in Indonesia",
       x = "Longitude",
       y = "Latitude",
       fill = "Total Plastics") +
  theme_minimal() +
  theme(panel.grid.major = element_line(color = "gray", linetype = "dotted"),
        plot.title = element_text(hjust = 0.5, size = 16, face = "bold"))


```


